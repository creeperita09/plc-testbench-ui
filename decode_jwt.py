import jwt
from google.auth import jwt as google_jwt
import requests

jwt_token = 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjYwODNkZDU5ODE2NzNmNjYxZmRlOWRhZTY0NmI2ZjAzODBhMDE0NWMiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJuYmYiOjE2ODUzOTAwNTQsImF1ZCI6IjUyNDk1MzkwMzEwOC05NDRpYmg0OTR1Z29wNmk1NGpoMThndTJwa29rZmk5ci5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsInN1YiI6IjEwODQyNDEzNTE5Njg4OTQ3NTcyNiIsImVtYWlsIjoic3RlZmFuby5kYWxsb25hQGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJhenAiOiI1MjQ5NTM5MDMxMDgtOTQ0aWJoNDk0dWdvcDZpNTRqaDE4Z3UycGtva2ZpOXIuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJuYW1lIjoiU3RlZmFubyBEYWxsb25hIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FBY0hUdGVVcVNleGZ0X2NZTTU1Qm53eGZsOFpfYkFIbmRzV3Q3QXN4TnIwPXM5Ni1jIiwiZ2l2ZW5fbmFtZSI6IlN0ZWZhbm8iLCJmYW1pbHlfbmFtZSI6IkRhbGxvbmEiLCJpYXQiOjE2ODUzOTAzNTQsImV4cCI6MTY4NTM5Mzk1NCwianRpIjoiM2E3NmViNzYxYmRkZTViZjc4ZjRkODY0N2RmMzNhMWU1NGVjYjBkNyJ9.iEyu0BtCWVyrSLleVdpTKESKThrxo-3mRjPWyYwiaR7m0ocfLjx_BXh5pYN3i7gye6UrCQQCdVt-JYFXwB5Q-0mEyToyg2rRirtzxQ56BMlsHlPbWYO-NgNgUZheBXeZc4Us4SyyYZAVuA34bfrR526qxp7wp1X61J3PES4e_Rx5SZeQMkOuOszFJvDzkz4uvDLSmyORRVpYXLmQnuJdK30ikNwfohSphlVUebbBJoTo7k4-yoXX9yXK2JiN4_Xls5g9zmquKeeJ1ojyZm4DRu0V4AIkKAVgAc6yW2m1JddJ3dxnW-QVZXnbbB-xxgCiBBZvZomKClBoIcGszthpjg'

zscaler_public_key = '''-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqT7STSxZRTgEFFf6doHa
jSc1vk5jmzmM6BWuOo044EsaTc9eVEV/HjH/1DWzZtcrfTj+ni205apMTlKBW3UY
R+lyLHQ9FoZiDXYXK8poKSV5+Tm0Vls/5Kb8mkhVVqv7LgYEmvEY7HPY+i1nEGZC
a46ZXCOohJ0mBEtB9JVlpDIO+nN0hUMAYYdZ1KZWCMNf5J/aTZiShsorN2A38iSO
hdd+mcRM4iNL3gsLu99XhKnRqKoHeH83lVdfu1XBeoQzz5V6gA3kbRvhDwoIlTBe
Ma5l4yRdJAfdpkbFzqiwSgNdhbxTHnYYorDzKfr2rEFMdsMU0DHdeAZf711+1Cun
uQIDAQAB
-----END PUBLIC KEY-----'''

google_public_key = '''-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmH4Fsul5JTVEAM4S7ywb
3qRiNjS2dsmKOkCCb95dLbJ5tkc4Wk6iwji8cxgsy4yxIYGPap/r20x7FPWV8+5X
wFofyfKQ+eyHBW9o0U6vPv6dm0Gs61JbAr7q4fU584giT5Xl/tvMT2Db5pWGjn1a
8No8jrlEXOaNlAB3ED1qoNGTTeBjxecVSyLKnTTahYaBJjF6MoAVprDreCdbUfUW
/bZ6UWnIXSAKH3IoDbqJxWMmalXOVwhDma3gLg2qa1emKVvU/0xiuDogq4/J0MJ0
h7yNvDrbxOsWAqXhGPbn6ZnKg27t2VCuQMZrq4Gl5eNEMjL7+C5m6TdPT2lOzkKR
bQIDAQAB
-----END PUBLIC KEY-----'''

google_cert = '''-----BEGIN CERTIFICATE-----
MIIDJjCCAg6gAwIBAgIIHH+X4p7dAcYwDQYJKoZIhvcNAQEFBQAwNjE0MDIGA1UE
AwwrZmVkZXJhdGVkLXNpZ25vbi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTAe
Fw0yMzA1MjYxNTIyNTBaFw0yMzA2MTIwMzM3NTBaMDYxNDAyBgNVBAMMK2ZlZGVy
YXRlZC1zaWdub24uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wggEiMA0GCSqG
SIb3DQEBAQUAA4IBDwAwggEKAoIBAQDWqtAJOy3dEXThowL1h7+QZuwTSx+0vgU6
0H9avMEM4V2t9XAt9+VC49fmQn7SJi/2vaaMPlggPLxv6IkrB69vr0hJ6g6uYve2
PoxK0l6xttFEtXIUib/ovtqUeFlXKodC0wpfsho2d2t95uctF4ae242TvpcIXEEG
dFojMBafOvdY3hQ8G3zgDQoXvil6LXt2WodknYcHYKxhsT06u3ybtV/qHDFjMW0K
8wKdmKXR8K2TY5DveXp6By9g7rkOQAmJsWwL3ECBloX70ZhGVKMw93RIxDzJT2Ld
btt5PTRfDoLQVgD0kBhoZo69tPzuX/pmQCSw4y68g8P+M1V9MI8tAgMBAAGjODA2
MAwGA1UdEwEB/wQCMAAwDgYDVR0PAQH/BAQDAgeAMBYGA1UdJQEB/wQMMAoGCCsG
AQUFBwMCMA0GCSqGSIb3DQEBBQUAA4IBAQC7E5WUoD1g3q829bHM5MtWrhbM6BLP
u+zocJ0UL9GcgGlw6sJ4/4rtFqSujezn6rXHUeAz3UFZFhmdbwVkQUZCdXHe2DbE
ubaZl2dbyrtEuiccqjavn7ay0Qjkv+exF/1aV/MlT+KMWSpmduBIwHTqUa/jg6iT
ocWp566q0KVg+F6cKhPRjeg2zYOfVJJ63F75K462URxyNqoNNgl2Vd0xFyaw/c5G
/nkYvq4jgXFjLst6RIlZls+TvLxb65Kc3BdlRkNIr7ZtZjVQzSAAlgAkRtFm19VN
s/OKyJLD1WRZtPeJ5m8DzHFEKHuDCE/jyMx0akaL5roPpk7VRHJaGeHB
-----END CERTIFICATE-----
'''

headers = {'Accept': 'application/json'}
r = requests.get('https://www.googleapis.com/oauth2/v1/certs', headers=headers)
certs = r.json()

user_data = jwt.decode(jwt_token, algorithms="RS256", options={"verify_signature": False})
user_data = google_jwt.decode(jwt_token, certs=certs)
print(user_data)